console.warn('Please update your htms cdn url to the new format');let files={},imports={};const delay=e=>new Promise(t=>setTimeout(t,e));async function SFile(e){return new Promise((t,l)=>{files[e]?t(files[e]):fetch(e).then(async l=>{l=await l.text(),files[e]=l,t(l)})})}function SReplace(e,t){if(e.outerHTML)e.outerHTML=t;else{var l=document.createElement("div");l.innerHTML="<!-- S-html replace -->",(ObjParent=e.parentNode).replaceChild(l,e),ObjParent.innerHTML=ObjParent.innerHTML.replace("<div><!-- S-html replace --></div>",t)}}function SUpdate(){document.head.innerHTML+="<style>htms{display:none ! important}</style>";let SMainElem=Array.from(document.getElementsByTagName("htms"));if(SMainElem.length>1)console.warn("Multiple htms elements provided, only the first one will take effect");else if(SMainElem.length<1){console.warn("HTMS was included but no config was detected");return}let SFig=(SMainElem=SMainElem[0]).innerHTML.split("\n").filter(e=>e.length>0);for(let line in SFig=(SFig=(SFig=SFig.map(e=>e.split(" ").filter(e=>e.length>0).join(" "))).filter(e=>e.length>0)).filter(e=>!e.startsWith("//"))){let args=(line=SFig[line]).split(" "),action=args[0];if("import"==action){if("from"!=args[2])throw Error('Import missing "from"');args[3]=args[3].slice(1,args[3].length-1),SFile(args[3]).then(e=>{args[1].split(",").map(e=>e.slice(1,e.length-1)).forEach(t=>{let l=RegExp('<sample .*?name="'+t+'".*?>[^âœ“]*?</sample>');imports[t]=e.match(l)[0].replaceAll(/<sample .+?>|<\/sample>/g,"").trim()})})}else if("inject"==action){if("with"!=args[2])throw Error('Inject missing "with"');Array.from(document.getElementsByTagName(args[1].slice(1,args[1].length-1))).forEach(async e=>{for(let t=0;t<5;t++)imports[args[3].slice(1,args[3].length-1)]||await delay(500);if(imports[args[3].slice(1,args[3].length-1)]){let l=imports[args[3].slice(1,args[3].length-1)];(e.attributes.var||"").value&&e.attributes.var.value.split(";").filter(e=>e.length).forEach(e=>{l=l.replaceAll("${"+e.split(":")[0]+"}",e.split(":")[1])}),e.innerHTML=l}else throw Error(args[3].slice(1,args[3].length-1)+" was not defined when inject loaded")})}else if("replace"==action){if("with"!=args[2])throw Error('Replace missing "with"');Array.from(document.getElementsByTagName(args[1].slice(1,args[1].length-1))).forEach(async e=>{for(let t=0;t<5;t++)imports[args[3].slice(1,args[3].length-1)]||await delay(500);if(imports[args[3].slice(1,args[3].length-1)]){let l=imports[args[3].slice(1,args[3].length-1)];(e.attributes.var||"").value&&e.attributes.var.value.split(";").filter(e=>e.length).forEach(e=>{l=l.replaceAll("${"+e.split(":")[0]+"}",e.split(":")[1])}),SReplace(e,l)}else throw Error(args[3].slice(1,args[3].length-1)+" was not defined when replace loaded")})}else if("module"==action)fetch("https://htms.fsh.plus/module/"+args[1].slice(1,args[1].length-1)+"/module.js").then(async h=>{eval(h=await h.text())});else throw Error(action+" Is not a valid action")}var Sload=new Event("SLoad");document.dispatchEvent(Sload)}function SRemoveCache(){files={},imports={}}document.addEventListener("DOMContentLoaded",SUpdate),window.SUpdate=SUpdate,window.SRemoveCache=SRemoveCache;